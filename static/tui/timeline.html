<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/neon-animation/animations/slide-down-animation.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animation-runner-behavior.html">
<link rel="import" href="../../bower_components/neon-animation/neon-animatable-behavior.html">
<link rel="import" href="tweet.html">

<dom-module id="tui-timeline">

  <template>
    <div id="timeline">
      <template is="dom-repeat" items="{{tweets}}">
        <tui-tweet tweet={{item}}></tui-tweet>
      </template>
    </div>
  </template>

  <script src="../../src/renderer/twitter.js">
  </script>

  <script>
    Polymer({
        is: "tui-timeline",

        behaviors: [
            Polymer.NeonAnimatableBehavior,
            Polymer.NeonAnimationRunnerBehavior
        ],

        properties: {
            tweets: {
                type: Array,
                value: []
            },

            animationConfig: {
                type: Object,
                value: function() {
                    return {
                        'append': [{
                          name: 'slide-down-animation'
                        }]
                    };
                }
            }
        },

        animate: function(name, t) {
            this.animationConfig[name][0].node = t;
            this.playAnimation(name);
        },

        ready: function() {
            var timeline = Polymer.dom(this.$.timeline);

            // Note: I can remove 'self' using arrow functions in ES6.
            var self = this;

            on_tweet(function(tweet){
                var inner_tw = document.createElement('tui-tweet');
                inner_tw.tweet = tweet;
                var tw = document.createElement('div');
                tw.id = "tweet";
                tw.appendChild(inner_tw);

                timeline.insertBefore(tw, timeline.firstChild);
                self.animate('append', tw);
            });
        }
    });
  </script>
</dom-module>
